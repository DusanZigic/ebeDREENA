<h1><img src="logo/qhptomography.png" alt="logo" width='215' align="right"/> ebeDREENA</h1>

ebeDREENA is computational framework for generating high-pT predictions based on a dynamical energy loss formalism. The framework can include any, in principle arbitrary, event-by-event fluctuating temperature evolution within the dynamical energy loss formalism. This version is generalized to account for both LHC and RHIC energies and collision systems.

<h2> < 1 > compilation</h2>

Compilation of the source code, performed using gcc compiler:

g++ source/*.cpp -fopenmp -O3 -o ebeDREENA

a) -fopenmp is necessary to enable parallelization using OpenMP;  
b) -O3 optimization is not necessary, but recommended;  
c) -o DREENAA is optional and if omitted, the output of the compilation will be placed in a.out;  

## < 2 > prerequisite files

All prerequisite files need to be textual tables or binary files. Textual tables can have a different number of columns depending on the file and they can contain header lines that start with '#' symbol;  

### a) initial pT distributions  
initial pT distributions file should have 2 columns in format: pT | dsigma/d(pT^2);
for heavy flavor, initial pT distributions can be obtained from http://www.lpthe.jussieu.fr/~cacciari/fonll/fonllform.html;  
IMPORTANT: note that the default output of this web interface is dsigma/dpT, while ebeDREENA initial pT distribution input needs to be dsigma/d(pT^2), so these distributions need to be modified; to avoid modifying different parameters that are hard-coded, initial pT distribution for heavy flavour should be in the range of 1GeV to at least 200GeV and for light flavour from 1GeV to at least 450GeV; for most distributions pT step of 1GeV seems to be sufficient;  
initial pT distribution file path relative to the executable should be: ./pTDists/ptDists[sNN]/ptDist_[sNN]_[particleName].dat, where [sNN] is collision energy that can be 200GeV, 2760GeV, 5020GeV and [particleName] is the name of the particle that can be Bottom, Charm, Down, DownBar, Gluon, Strange, Up, UpBar;  

### b) temperature evolutions  
temperature evolution files should be in binary format as 32bit floating point numbers;  
temperature evolution file path relative to the executable should be: ./evols/evols_cent=[centrality]/tempevol[eventID].dat, where [centrality] is centrality parameter in format 'xx-xx%' (ie 0-5%, 10-20%,...), and [eventID] is non negative integer that represents event's ID;  
within this repository there is an example temperature evolution file generated evolving Monte Carlo Glauber initial condition with 3D hydro for 5020GeV Pb+Pb collision (see arxiv:2208.09886 for more details);

### c) temperature evolution grid parameters file  
temperature evolution grid parameters file is located in the same directory as the temperature evolution files: ./evols/evols_cent=[centrality]/evolgridparams.dat, where [centrality] is centrality parameter in format 'xx-xx%' (ie 0-5%, 10-20%,...);  
this file contains temperature evolution grid parameters sush as tau0, x and y grid ranges and steps;  
this format for evolutions is chosen to save storage space and import time;
within this repository there is an example temperature evolution grid parameter file that corresponds to provided temperature evolution;

### d) binary collision points  
binary collision points path relative to the executable should be: ./binarycollpts/binarycollpts_cent=[centrality]/binarycollpts[eventID].dat, where [centrality] is centrality parameter in format 'xx-xx%' (ie 0-5%, 10-20%,...), and [eventID] is non negative integer that represents event's ID;  
binary collision points are generated by initial condition model and are used to generate jet's initial positions in x-y plane, while direction angles are uniformly distributed;  
within this repository there is an example of binary collision points file generated using Monte Carlo Glauber initial condition model, and the same initial conditions are evolved to generate temperature evolution provided in this repository (see arxiv:2208.09886 for more details);  

### e) LTables  
LTables files contain pre-generated radiated gluon rates and collisional energy loss; for radiative energy loss, there are 2 tables LNorm table with column format: tau | p | temp | LNorm and Ldndx table with column format: tau | p | temp | x | Ldndx; these tables are also a function of particle mass (particle name is in file name), chromo-magnetic to electric mass ratio, xB, (xB value is in file names) and effective number of flavours, nf (nf is in file name and depends of collision energy: nf=2.5 for 200GeV and nf=3.0 for LHC energies);  
for collisional energy loss, there is one table LColl with column format: p | temp | LColl; this table is also a function of particle mass (particle name is in file name) and effective number of flavours, nf;  
LTables files path relative to the executable should be: ./ltables/lnorm_nf=[nf]\_[particleName]\_xB=[xB].dat, ./ltables/ldndx_nf=[nf]\_[particleName]\_xB=[xB].dat, ./ltables/lcoll_nf=[nf]_[particleName].dat, where [nf] is the effective number of flavours that can be 2.5 for 200GeV or 3.0 for LHC energy collisions, [particleName] is the name of the particle that can be Bottom, Charm, LQuarks or Gluon (all light quarks are taken to have same mass, so their LTables are the same), and [xB] is the chromo-magnetic to electric mass ratio;  
unlike previous files, ebeDREENA calculates LTables; however, these tables need to be calculated only once and can be reused while calculating high-pT energy loss with different temperature evolution backgrounds;
within this repository there is an example of LTables files for Charm quark, nf=3.0 and xB=0.6;  

## < 2 > running ebeDREENA  
There are two possible calculation options within ebeDREENA framework: LTables calculation and energy loss calculation. Since ebeDREENA is parallelized using OpenMP, set OMP_NUM_THREADS environmental variable to desired value before running calculations.

### a) LTables calculation  
to perform basic LTables calculation use command: ./ebeDREENA LTables --sNN=[sNN] --pName=[particleName] --xB=[xB]  
-sNN parameter: case sensitive string with possible options: 200GeV, 2760GeV, 5020GeV, 5440GeV;  
-particleName parameter: case sensitive string with possible options: Bottom, Charm, LQuarks, Gluon, where LQuarks stand for light quarks, since all light quarks (down, down-bar, strange, strange-bar, up and up-bar) use the same LTables;  
-xB parameter: float that represents magnetic to electric mass ratio; based on lattice calculation: xB=0.6;  
for example, to calculate LTables for charm quark for 5020GeV LHC collision and for xB=0.6, which are LTables provided in this demo, command should be: ./ebeDREENA LTables --sNN=5020GeV --pName=Charm --xB=0.6;  
additional parameters are number of points used for QuasiMonteCarlo integration LdndxMaxPoints and LCollMaxPoints;  
to see all available parameters for LTables calculation and their default values use: ./ebeDREENA LTables -h;  

### b) energy loss calculation
